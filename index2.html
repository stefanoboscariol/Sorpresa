<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TANTI AUGURI FLAâœ¨</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #89f7fe, #66a6ff); /* tema blu/azzurro */
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
      color: #333;
      overflow: hidden;
    }

    .card {
      background: #f0f8ff; /* carta chiara azzurra */
      padding: 2.5rem 2rem;
      border-radius: 24px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      max-width: 420px;
      width: 90%;
      text-align: center;
      animation: pop 0.6s ease-out;
    }

    @keyframes pop {
      from { transform: scale(0.85); opacity: 0; }
      to   { transform: scale(1); opacity: 1; }
    }

    h1 { font-size: 1.9rem; margin-bottom: 1rem; color: #2575fc; } 
    p  { font-size: 1.05rem; line-height: 1.5; margin-bottom: 1rem; }

    button {
      background: linear-gradient(135deg, #6a11cb, #2575fc);
      border: none;
      color: white;
      font-size: 1rem;
      padding: 0.7rem 1.4rem;
      border-radius: 999px;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(38,79,255,0.4);
      transition: transform 0.15s ease, box-shadow 0.15s ease;
      margin-top: 0.5rem;
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 26px rgba(38,79,255,0.5);
    }

    .hidden { display: none; }
    .choices button {
      margin: 0.35rem;
      padding: 0.6rem 1.1rem;
      font-size: 0.95rem;
    }

    .dots { position: relative; height: 180px; margin: 1rem 0; }
    .dot { width: 22px; height: 22px; background: #2575fc; border-radius: 50%; position: absolute; cursor: pointer; }
    canvas { position: absolute; top:0; left:0; }

    /* Tap rapido grid */
    #tapGrid {
      position: relative;
      width: 100%;
      height: 200px;
      margin: 1rem 0;
      border: 2px dashed #2575fc;
      border-radius: 16px;
      overflow: hidden;
    }

    .timer { font-weight: bold; margin-bottom: 0.5rem; color:#ff4444; }

    .heart { position: absolute; bottom: -20px; font-size: 20px; animation: floatUp 5s linear infinite; opacity: 0.7; }
    @keyframes floatUp { from { transform: translateY(0) scale(1); opacity: 0.7; } to { transform: translateY(-110vh) scale(1.6); opacity: 0; } }

    /* Fulmini pagina finale */
    .lightning {
      position: absolute;
      font-size: 2rem;
      color: #ffff33;
      top: -50px;
      animation: fall 2s linear infinite;
    }
    @keyframes fall {
      from { transform: translateY(-50px) rotate(0deg); }
      to { transform: translateY(110vh) rotate(20deg); }
    }
  </style>
</head>
<body>

  <!-- LIVELLO 1 -->
  <div class="card" id="lvl1">
    <h1>ğŸ‘‹Ciao Flavietta!</h1>
    <p>Questa Ã¨ una piccola sorpresaâ€¦<br>ma per arrivare in fondo dovrai <b>guadagnartela</b> ğŸ˜‰</p>
    <button onclick="goTo('lvl1','lvl2')">Iniziamo ğŸ®</button>
  </div>

  <!-- LIVELLO 2: puntini -->
  <div class="card hidden" id="lvl2">
    <h1>ğŸ§© Livello 1</h1>
    <p>Unisci i puntini <b>in ordine</b> (1 â†’ 2 â†’ 3)</p>
    <p><i>Dai, Ã¨ piÃ¹ facile di un puzzle da bambini ğŸ˜„</i></p>
    <div class="dots">
      <canvas id="lineCanvas" width="360" height="180"></canvas>
      <div class="dot" style="top:120px; left:40px" onclick="hitDot(1)"></div>
      <div class="dot" style="top:40px; left:170px" onclick="hitDot(2)"></div>
      <div class="dot" style="top:120px; left:300px" onclick="hitDot(3)"></div>
    </div>
  </div>

  <!-- LIVELLO 3: matematica -->
  <div class="card hidden" id="lvl3">
    <h1>â• Livello 2</h1>
    <p>Concentrazione massima ğŸ§ </p>
    <p><b>Quanto fa 7 Ã— 6?</b></p>
    <div class="choices">
      <button onclick="mathWrong()">36</button>
      <button onclick="mathRight()">42</button>
      <button onclick="mathWrong()">48</button>
    </div>
    <p id="mathMsg"></p>
  </div>

  <!-- LIVELLO 4: memory semplice -->
  <div class="card hidden" id="lvl4">
    <h1>ğŸƒ Livello 3</h1>
    <p>Scegli il colore corrispondente alla scritta</p>
    <div class="choices">
      <button style="background:#ff6a88;" onclick="memoryRight()">Rosa</button>
      <button style="background:#6a11cb;" onclick="memoryWrong()">Verde</button>
      <button style="background:#2575fc;" onclick="memoryWrong()">Bianco</button>
    </div>
    <p class="timer" id="memoryTimer">Tempo rimasto: 10s</p>
    <p id="memoryMsg"></p>
  </div>

  <!-- LIVELLO 5: tap rapido -->
  <div class="card hidden" id="lvl5">
    <h1>âš¡ Livello 4</h1>
    <p>Tocca tutti i fulmini che si accendono! âš¡</p>
    <p><small>Hai <b>10 secondi</b> per trovarne almeno <b>3</b>!</small></p>
    <div class="tap-grid" id="tapGrid"></div>
    <p class="timer" id="tapTimer">Tempo rimasto: 10s</p>
    <p id="tapScore"></p>
  </div>

  <!-- LIVELLO 6: scelta simpatica -->
  <div class="card hidden" id="lvl6">
    <h1>ğŸ˜ Livello 5</h1>
    <p>Scegli una risposta per continuare:</p>
    <div class="choices">
      <button onclick="choiceWrong()">Non so ğŸ¤”</button>
      <button onclick="choiceRight()">Ovviamente sÃ¬! ğŸ‰</button>
    </div>
  </div>

  <!-- LIVELLO 7: messaggio finale auguri -->
  <div class="card hidden" id="lvl7">
    <h1>ğŸ‰ Auguri!</h1>
    <p>Hai superato tutti i livelli! ğŸ†<br>Sei fantastica e meriti tutto il meglio ğŸŒŸğŸ’™ğŸ«¶ğŸ»</p>
    <button onclick="spawnFinalEffects()">Effetti finali âœ¨</button>
  </div>

  <script>
    /* Navigazione */
    function goTo(from, to) {
      document.getElementById(from).classList.add('hidden');
      document.getElementById(to).classList.remove('hidden');
    }

    /* Puntini */
    let currentDot = 1;
    const canvas = document.getElementById('lineCanvas');
    const ctx = canvas.getContext('2d');
    let lastPos = null;
    function hitDot(n) {
      if (n !== currentDot) return;
      const dot = event.target;
      const rect = dot.getBoundingClientRect();
      const parent = dot.parentElement.getBoundingClientRect();
      const x = rect.left - parent.left + 11;
      const y = rect.top - parent.top + 11;
      if (lastPos) { 
        ctx.beginPath();
        ctx.moveTo(lastPos.x,lastPos.y);
        ctx.lineTo(x,y);
        ctx.strokeStyle='#2575fc';
        ctx.lineWidth=4;
        ctx.stroke(); 
      }
      lastPos = {x,y};
      currentDot++;
      if(currentDot===4){setTimeout(()=>goTo('lvl2','lvl3'),600);}
    }

    /* Matematica */
    function mathWrong(){ document.getElementById('mathMsg').textContent='Mhâ€¦ riprova, so che puoi ğŸ˜'; }
    function mathRight(){ 
      document.getElementById('mathMsg').textContent='Perfetto! Sapevo che ce lâ€™avevi ğŸ˜'; 
      setTimeout(()=>goTo('lvl3','lvl4'),900); 
    }

    /* Memory */
    function memoryWrong(){ document.getElementById('memoryMsg').textContent='Oops! Ricorda meglio ğŸ˜…'; }
    function memoryRight(){ 
      document.getElementById('memoryMsg').textContent='Bravo! ğŸ’ª'; 
      setTimeout(()=>goTo('lvl4','lvl5'),800); 
    }

    /* Timer livello 4 memory/tap */
    function startMemoryTimer() {
      let time = 10;
      const timerEl = document.getElementById('memoryTimer');
      const interval = setInterval(()=>{
        time--;
        timerEl.textContent = `Tempo rimasto: ${time}s`;
        if(time<=0){
          clearInterval(interval);
          timerEl.textContent = 'Tempo scaduto! ğŸ˜…';
          setTimeout(()=>goTo('lvl4','lvl5'),1000);
        }
      },1000);
    }
    const lvl4 = document.getElementById('lvl4');
    const observer4 = new MutationObserver(()=>{ startMemoryTimer(); });
    observer4.observe(lvl4,{attributes:true,attributeFilter:['class']});

    /* Tap rapido livello 5 */
    function startTapGame() {
      const grid = document.getElementById('tapGrid');
      const scoreDisplay = document.getElementById('tapScore');
      const timerEl = document.getElementById('tapTimer');
      grid.innerHTML = '';
      scoreDisplay.textContent = '';
      let heartsClicked = 0;
      const totalHearts = 8;

      for(let i=0;i<totalHearts;i++){
        const bolt = document.createElement('button');
        bolt.textContent = 'âš¡';
        bolt.style.position = 'absolute';
        bolt.style.top = Math.random()*160 + 'px';
        bolt.style.left = Math.random()*320 + 'px';
        bolt.style.fontSize = '2rem';
        bolt.style.border = 'none';
        bolt.style.background = 'transparent';
        bolt.style.cursor = 'pointer';
        bolt.addEventListener('click',()=>{
          heartsClicked++;
          bolt.remove();
          scoreDisplay.textContent = `Fulmini cliccati: ${heartsClicked}`;
        });
        grid.appendChild(bolt);
      }

      let time = 10;
      const interval = setInterval(()=>{
        time--;
        timerEl.textContent = `Tempo rimasto: ${time}s`;
        if(time<=0){
          clearInterval(interval);
          scoreDisplay.textContent = `Tempo scaduto! Fulmini cliccati: ${heartsClicked}`;
          setTimeout(()=>goTo('lvl5','lvl6'),1000);
        }
      },1000);
    }
    const lvl5 = document.getElementById('lvl5');
    const observer5 = new MutationObserver(()=>{ startTapGame(); });
    observer5.observe(lvl5,{attributes:true,attributeFilter:['class']});

    /* Scelta simpatica */
    function choiceWrong(){ alert('Mhâ€¦ prova ancora ğŸ˜'); }
    function choiceRight(){ goTo('lvl6','lvl7'); spawnFinalEffects(); }

    /* Effetti finali */
    function spawnFinalEffects(){
      // cuori blu
      for(let i=0;i<5;i++){
        const heart=document.createElement('div');
        heart.className='heart';
        heart.textContent='ğŸ’™';
        heart.style.left=Math.random()*100+'vw';
        heart.style.animationDuration=(3+Math.random()*3)+'s';
        document.body.appendChild(heart);
        setTimeout(()=>heart.remove(),6000);
      }
      // fulmini
      for(let i=0;i<7;i++){
        const bolt=document.createElement('div');
        bolt.className='lightning';
        bolt.style.left=Math.random()*100+'vw';
        document.body.appendChild(bolt);
        setTimeout(()=>bolt.remove(),6000);
      }
      // emoji ğŸ«¶ğŸ»
      for(let i=0;i<10;i++){
        const emoji=document.createElement('div');
        emoji.textContent='ğŸ«¶ğŸ»';
        emoji.style.position='absolute';
        emoji.style.left=Math.random()*100+'vw';
        emoji.style.top=Math.random()*90+'vh';
        emoji.style.fontSize='2rem';
        document.body.appendChild(emoji);
        setTimeout(()=>emoji.remove(),6000);
      }
    }
  </script>
</body>
</html>
